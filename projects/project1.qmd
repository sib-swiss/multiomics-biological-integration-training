---
title: "Project 1"
execute:
  eval: false
project:
  execute-dir: project
format: html
editor_options: 
  chunk_output_type: console
---

## Description

In mouse embryonic brain development at E11.5 (early neural tube patterning and initial regionalization) and E15.5 (mid-neurogenesis, progenitor expansion, and early differentiation), brain regionalization into forebrain (prosencephalon/telencephalon/diencephalon), midbrain (mesencephalon), and hindbrain (rhombencephalon) relies on key signaling centers (e.g., mid-hindbrain boundary/isthmus) and transcription factors (TFs). These TFs are encoded on various chromosomes, with no single chromosome dominating the process—development involves distributed genetic networks across the genome.

### Forebrain

#### Major TFs and genes at E11.5–E15.5

FOXG1 (rostral/ventral identity), PAX6 (dorsal pallium/cortex patterning), EMX2, LHX2, OTX1/OTX2 (anterior neural plate/forebrain vs. midbrain boundary), NR2F1/COUP-TFI, SP8, MEIS2, ARX, DMRT3/DMRT5, SOX2/SOX3 (progenitors), SOX4/SOX11 (neurogenesis commitment), DLX1/2/5/6 (ventral/subpallial GABAergic neurons).

#### Important chromosomes (examples of key genes):

```
Chr1: Foxg1
Chr2: Pax6, Lhx2
Chr5: Otx2 (critical for forebrain vs. midbrain separation; also active in ventral forebrain)
ChrX: Arx
```

#### At E11.5: Strong anterior-posterior (A-P) and dorsal-ventral (D-V) gradients establish pallial/subpallial domains.

#### At E15.5: Neurogenesis ramps up; enhancers active in forebrain show dynamic chromatin (e.g., H3K27ac/H3K4me1) linked to these TFs.

This project focuses on E11.5 and E15.5 forebrain samples. WGBS should be treated as an observation-level assay (CpG-level methylation proportions with coverage) and represented as BSseq/GenomicRatioSet or a CpG BED with methylation and coverage prior to integration. Students will integrate RNA-seq, ATAC-seq, WGBS, and histone modification (H3K4me3, H3K27ac, H3K27me3, H3K4me1) data to identify regulatory programs and epigenomic changes during forebrain development. Deliverables: an analysis report, figures highlighting differential expression/peaks/methylation, and a short presentation.


## Available data

Data has been downloaded and prepared for you from [Mouse Development Matrix: Forebrain](https://www.encodeproject.org/mouse-development-matrix/?type=Experiment&status=released&related_series.@type=OrganismDevelopmentSeries&replicates.library.biosample.organism.scientific_name=Mus+musculus#forebrain)

Students should download project data (group projects) from:
https://multiomics-biological-integration-training.s3.eu-central-1.amazonaws.com/project1.tar.gz

Setup in R

```{r}
# Download and extract project1 data into a folder named 'project1'
url <- "https://multiomics-biological-integration-training.s3.eu-central-1.amazonaws.com/project1.tar.gz"
dest <- "project1.tar.gz"
download.file(url, dest, mode = "wb")
utils::untar(dest, exdir = "project1")
```


After extracting, a directory project1 appears with the following content:

```
.
├── ATAC_11half.bw
├── ATAC_15half.bw
├── atac_se.rds
├── H3K27ac_11half.bw
├── H3K27ac_15half.bw
├── h3k27ac_se.rds
├── H3K27me3_11half.bw
├── H3K27me3_15half.bw
├── h3k27me3_se.rds
├── H3K4me1_11half.bw
├── H3K4me1_15half.bw
├── h3k4me1_se.rds
├── H3K4me3_11half.bw
├── H3K4me3_15half.bw
├── h3k4me3_se.rds
├── rna_se.rds
├── WGBS_11half.bed.gz
└── WGBS_15half.bed.gz
```

```
├─ rna_se.rds — SummarizedExperiment for RNA-seq (gene counts / normalized expression)
├─ atac_se.rds — SummarizedExperiment for ATAC-seq (peak counts / accessibility)
├─ h3k4me3_se.rds, h3k27ac_se.rds, h3k4me1_se.rds, h3k27me3_se.rds — SummarizedExperiments for histone marks (peak-level assays)
├─ *.bw (e.g., H3K4me3_11half.bw, ATAC_15half.bw) — bigWig signal tracks for visualization
├─ WGBS_11half.bed.gz, WGBS_15half.bed.gz — CpG-level methylation (columns typically: chr, start, end, methylation_prop, coverage); treat as observation assay
```

The provided assay objects are `RangedSummarizedExperiment` (assay names: "counts", "logCPM") with `rowRanges` as `GRanges` and `colData` including sample/group fields; differential analyses have already been performed and are reflected in the supplied objects. Students should therefore focus on interpretation and integrative analysis rather than re-running DE tests.



## Day 1

- Explore the dataset for the project:

  - How many samples are there?
  - Is the data properly normalized?
  - How about a volcano plot to visualize the differences?
  - How many chromosomes are present in the data?
  
- ATAC-seq data

  - How many peaks are there?
  - How many differentially accessible peaks are there between E11.5 and E15.5?
  - What is the median width of the ATAC peaks?
  
- Normalizing and plotting

  - Use correct normalization method for each dataset.
  - Can you divide the `EnrichedHeatmap` for increse and decrease in accessibility regions?
  - How about also dividng `EnrichedHeatmap` for different annotations?

- ChIP-seq data
  
  - How many peaks are there for each histone mark?
  - How many differentially enriched peaks are there between E11.5 and E15.5 for each mark?
  - What is the median width of the peaks for each mark?
  
- RNA-seq data

  - How many genes are there?
  - How many differentially expressed genes are there between E11.5 and E15.5?
  - **Gene Expression Boxplots:** For key forebrain transcription factors like `FOXG1`, `PAX6`, and `EMX2`, create boxplots showing their normalized expression levels across samples for E11.5 and E15.5. Analyze how their expression changes between these two developmental stages.


## Day 2

- `overlapMatrix`

  - As done during the course exercise, make the `overlapMatrix` for your data.
  - Similar to [Exercise 5](https://sib-swiss.github.io/multiomics-biological-integration-training/day2/day2-2_atac_rna.html), find different regions of activity in your data.
  
- Integrative analysis
  - Can you identify enhancers in the data?
  - Are there any repressed promoters?
  - Can you identify regions with increased chromatin accessibility, increased H3K27ac and H3K4me3, increased gene expression and which are less than 2.kb of TSS? what would you call these regions?

## Day 3

- Enrichment analysis
  - Can you find any enriched GO terms in the Gained Enhancer regions in E15.5 compared to E11.5?
  - Can you find any enriched GO terms in the Repressed Promoter regions in E15?
  - What biological significant GO terms did you find in these regions? Do they make sense in the context of development?


## Advanced analysis
- How many gained enhancers near Pax6/Lhx2 appear from E11.5 to E15.5, and do they link to RNA-seq upregulation?
- Obtain `overlapMatrix` from other brain region from your colleagues.
- Merge `overlapMatrices` from all three regions to compare co-occurring signals.
- Generate shared vs. unique regulatory regions (e.g., Venn diagram of gained enhancers).
- Are there region-specific regulatory programs distinguishing forebrain/midbrain/hindbrain projects?
